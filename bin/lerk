#! /usr/bin/env ruby
# encoding: utf-8

require 'bundler/setup'

if ENV.fetch('DEVELOPMENT', false)
  require 'dotenv'
  Dotenv.load
end

require 'lerk'

puts 'Starting prometheus exporter'
t = Thread.new do
  Lerk::PrometheusExporter.run_exporter
end
puts 'Running'

lerk = Lerk::Lerk.new(
  client_id:         Lerk::Config::DISCORD_CLIENT_ID,
  token:             Lerk::Config::DISCORD_TOKEN,
  prefix:            Lerk::Config::LERK_COMMAND_PREFIX,
)
puts "Invite me: #{ lerk.invite_url }"
lerk.run
